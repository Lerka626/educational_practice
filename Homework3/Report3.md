# 1.1 Сравнение моделей разной глубины
В терминале:
Running experiment with 1 layers...
Training time for 1 layers: 12.13 seconds
Final Train Accuracy: 0.6562
Final Test Accuracy: 0.6600

Running experiment with 2 layers...
Training time for 2 layers: 2.39 seconds
Final Train Accuracy: 0.9750
Final Test Accuracy: 0.8225

Running experiment with 3 layers...
Training time for 3 layers: 3.07 seconds
Final Train Accuracy: 1.0000
Final Test Accuracy: 0.8600

Running experiment with 5 layers...
Training time for 5 layers: 3.64 seconds
Final Train Accuracy: 0.9600
Final Test Accuracy: 0.8375

Running experiment with 7 layers...
Training time for 7 layers: 4.44 seconds
Final Train Accuracy: 0.9725
Final Test Accuracy: 0.8325


# 1.2 Анализ переобучения
На CPU решение в файле + изображения в plots. В терминале:
Анализ переобучения:
Переобучение: глубина 2, эпоха 9 (train=0.604, test=0.498)
Переобучение: глубина 3, эпоха 8 (train=0.628, test=0.518)
Переобучение: глубина 5, эпоха 7 (train=0.619, test=0.516)
Переобучение: глубина 7, эпоха 8 (train=0.628, test=0.528)
Глубина 1 итог тест acc: 0.3441
Глубина 2 итог тест acc: 0.4973
Глубина 3 итог тест acc: 0.5212
Глубина 5 итог тест acc: 0.5321
Глубина 7 итог тест acc: 0.5385
Лучший depth без рег: 7 (acc=0.5385)
Глубина 1 с рег итог acc: 0.3179
Глубина 2 с рег итог acc: 0.5582
Глубина 3 с рег итог acc: 0.5797
Глубина 5 с рег итог acc: 0.5754
Глубина 7 с рег итог acc: 0.5726
Лучший depth с рег: 3 (acc=0.5797)


На GPU решение через google colab, код тот же, результат:
Анализ переобучения:
Переобучение: глубина 2, эпоха 9 (train=0.604, test=0.477)
Переобучение: глубина 3, эпоха 7 (train=0.617, test=0.515)
Переобучение: глубина 5, эпоха 8 (train=0.640, test=0.536)
Переобучение: глубина 7, эпоха 9 (train=0.649, test=0.534)
Глубина 1 итог тест acc: 0.3469
Глубина 2 итог тест acc: 0.5134
Глубина 3 итог тест acc: 0.5157
Глубина 5 итог тест acc: 0.5302
Глубина 7 итог тест acc: 0.5326
Лучший depth без рег: 7 (acc=0.5326)
Глубина 1 с рег итог acc: 0.3309
Глубина 2 с рег итог acc: 0.5541
Глубина 3 с рег итог acc: 0.5820
Глубина 5 с рег итог acc: 0.5795
Глубина 7 с рег итог acc: 0.5749
Лучший depth с рег: 3 (acc=0.5820)

В plots есть файл под названием "ПримерГрафикаНа_GPU_МожноСравнитьС_Ч7", это скрин одного из графиков на GPU (Tesla T4). Графики примерно похожи, но где-то он более гладкий, а где-то более резкий в углах. Например, если у CPU более гладкий график функции Test acc, то у GPU он более резкий, как ломаная, и наоборот. Интересно и то, что один и тот же код дал чуть-чуть разный результат, начиная с сотых.
Еще можно добавить, что на GPU обучение заняло гдето 3-3,5 часа, а на CPU оно обучалось ~8 часов.

# 2.1 Сравнение моделей разной ширины
Время обучения (Узкие): 314.20 сек
Тестовая точность (Узкие): 0.9722

Время обучения (Средние): 392.28 сек
Тестовая точность (Средние): 0.9792

Время обучения (Широкие): 570.69 сек
Тестовая точность (Широкие): 0.9827

Время обучения (Очень широкие): 1185.17 сек
Тестовая точность (Очень широкие): 0.9818

Итог: оптимальная по времени и лучшая по точности - широкие (одна эпоха за ~40-45сек).

# 2.2 Оптимизация архитектуры
Терминал:
Архитектура: Постоянная 64 — ширины [64, 64, 64]
Постоянная 64: тестовая точность=0.9724, время=164.1 сек

Архитектура: Сужение 64->64 — ширины [64, 64, 32]
Сужение 64->64: тестовая точность=0.9705, время=187.5 сек

Архитектура: Расширение 64->64 — ширины [32, 64, 64]
Расширение 64->64: тестовая точность=0.9626, время=190.3 сек

Архитектура: Постоянная 64 — ширины [64, 64, 64]
Постоянная 64: тестовая точность=0.9657, время=180.3 сек

Архитектура: Сужение 64->128 — ширины [128, 64, 32]
Сужение 64->128: тестовая точность=0.9730, время=198.6 сек

Архитектура: Расширение 64->128 — ширины [32, 64, 128]
Расширение 64->128: тестовая точность=0.9662, время=189.1 сек

Архитектура: Постоянная 64 — ширины [64, 64, 64]
Постоянная 64: тестовая точность=0.9698, время=221.8 сек

Архитектура: Сужение 64->256 — ширины [256, 64, 32]
Сужение 64->256: тестовая точность=0.9721, время=216.7 сек

Архитектура: Расширение 64->256 — ширины [32, 64, 256]
Расширение 64->256: тестовая точность=0.9669, время=192.2 сек

Архитектура: Постоянная 64 — ширины [64, 64, 64]
Постоянная 64: тестовая точность=0.9724, время=185.9 сек

Архитектура: Сужение 64->512 — ширины [512, 64, 32]
Сужение 64->512: тестовая точность=0.9795, время=206.2 сек

Архитектура: Расширение 64->512 — ширины [32, 64, 512]
Расширение 64->512: тестовая точность=0.9648, время=205.2 сек

Архитектура: Постоянная 128 — ширины [128, 128, 128]
Постоянная 128: тестовая точность=0.9678, время=199.5 сек

Архитектура: Сужение 128->64 — ширины [128, 64, 32]
Сужение 128->64: тестовая точность=0.9724, время=190.9 сек

Архитектура: Расширение 128->64 — ширины [32, 64, 128]
Расширение 128->64: тестовая точность=0.9644, время=217.0 сек

Архитектура: Постоянная 128 — ширины [128, 128, 128]
Постоянная 128: тестовая точность=0.9790, время=205.4 сек

Архитектура: Сужение 128->128 — ширины [128, 128, 64]
Сужение 128->128: тестовая точность=0.9771, время=206.9 сек

Архитектура: Расширение 128->128 — ширины [64, 128, 128]
Расширение 128->128: тестовая точность=0.9692, время=205.6 сек

Расширение 128->128: тестовая точность=0.9692, время=205.6 сек
А далее я случайно остановила...

После дедлайна у меня закончилось обучение на GPU и я получила график Heatmap (я добавлю в plots, но если это не принимается, то просто не берите это в рассчет)

В 13:00 у меня закончилось обучение на CPU, карту так же прикрепила в plods ("Figure_1_Heatmap_CPU").

# 3.1 Сравнение техник регуляризации
ТК очень долго все обучается и я не успевала, это задание я выполняла только на google colab...
скрины всех графиков в plots

# 3.2 Адаптивная регуляризация

